# Last Modified: Tue Feb 21 22:54:21 2017
#include <tunables/global>

/usr/bin/gkrellmd {
  #include <abstractions/base>
  #include <abstractions/consoles>
  #include <abstractions/nameservice>
  #include <abstractions/wutmp>

  capability setgid,
  capability setuid,

  / r,
  /bin/bash Cx,
  /bin/bash mr,
  /etc/fstab r,
  /etc/gkrellmd.conf r,
  /proc/*/fd/ r,
  /proc/*/mounts r,
  /proc/*/net/dev r,
  /proc/*/net/ipv6_route r,
  /proc/*/net/route r,
  /proc/*/net/tcp r,
  /proc/*/net/tcp6 r,
  /proc/*/net/udp r,
  /proc/*/net/udp6 r,
  /proc/diskstats r,
  /proc/loadavg r,
  /proc/sys/kernel/osrelease r,
  /proc/uptime r,
  /proc/vmstat r,
  /run/gkrellmd.pid w,
  /sys/class/hwmon/ r,
  /sys/class/power_supply/ r,
  /sys/class/thermal/ r,
  /sys/devices/**/power_supply/AC/* r,
  /sys/devices/**/power_supply/BAT[0-9]/* r,
  /sys/devices/platform/coretemp.[0-9]/ r,
  /sys/devices/platform/coretemp.[0-9]/** r,
  /sys/devices/virtual/thermal/thermal_zone[0-9]/temp r,
  /usr/bin/eject r,
  /usr/bin/gkrellmd mr,


  profile /bin/bash {
    #include <abstractions/base>
    #include <abstractions/consoles>
    #include <abstractions/nameservice>

    / r,
    /bin/bash mr,
    /usr/bin/eject mr,
    /usr/bin/eject rix,

  }
}
