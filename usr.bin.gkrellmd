# Last Modified: Tue Feb 21 17:33:56 2017
#include <tunables/global>

/usr/bin/gkrellmd {
  #include <abstractions/base>
  #include <abstractions/nameservice>
  #include <abstractions/wutmp>

  capability setgid,
  capability setuid,

  /bin/bash Cx,
  /etc/fstab r,
  /etc/gkrellmd.conf r,
  /proc/*/fd/ r,
  /proc/*/mounts r,
  /proc/*/net/dev r,
  /proc/*/net/ipv6_route r,
  /proc/*/net/route r,
  /proc/*/net/tcp r,
  /proc/*/net/tcp6 r,
  /proc/*/net/udp r,
  /proc/*/net/udp6 r,
  /proc/diskstats r,
  /proc/loadavg r,
  /proc/sys/kernel/osrelease r,
  /proc/uptime r,
  /proc/vmstat r,
  /run/gkrellmd.pid w,
  /sys/class/hwmon/ r,
  /sys/class/power_supply/ r,
  /sys/class/thermal/ r,
  /sys/devices/**/power_supply/AC/online r,
  /sys/devices/**/power_supply/AC/type r,
  /sys/devices/**/power_supply/BAT0/charge_full r,
  /sys/devices/**/power_supply/BAT0/charge_now r,
  /sys/devices/**/power_supply/BAT0/present r,
  /sys/devices/**/power_supply/BAT0/status r,
  /sys/devices/**/power_supply/BAT0/type r,
  /sys/devices/platform/coretemp.[0-9]/ r,
  /sys/devices/platform/coretemp.[0-9]/hwmon/hwmon[0-9]/ r,
  /sys/devices/platform/coretemp.[0-9]/hwmon/hwmon[0-9]/name r,
  /sys/devices/platform/coretemp.[0-9]/hwmon/hwmon[0-9]/temp[0-9]_input r,
  /sys/devices/virtual/thermal/thermal_zone0/temp r,
  /sys/devices/virtual/thermal/thermal_zone1/temp r,
  /usr/bin/gkrellmd mr,


  profile /bin/bash flags=(complain) {
    #include <abstractions/base>
    #include <abstractions/consoles>
    #include <abstractions/nameservice>

    / r,
    /bin/bash mr,
    /usr/bin/eject mr,
    /usr/bin/eject rix,

  }
}
